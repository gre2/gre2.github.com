---
layout: post
title: "（内存）java内存模型"
description: ""
category: [java,基础]
tags: [基础]
---
{% include JB/setup %}

# java内存模型 + 硬件内存结构

![1538731735287](C:\Users\17235\AppData\Roaming\Typora\typora-user-images\1538731735287.png)



java内存模型：指定jvm如何利用计算机内存RAM进行工作

### 缓存一致性

计算机在执行程序的时候，每条指令都在cpu中执行，而执行的时候，需要和计算机物理内存交互，但是随着cpu的迅猛发展，而内存技术没有太大的变化，所以内存中读取和写入数据的速度远远低于cpu的执行速度，所以想到了在cpu和内存中间加入**高速缓存**

**![1538740985627](C:\Users\17235\AppData\Roaming\Typora\typora-user-images\1538740985627.png)**

1.单线程（串行）：cpu核心缓存只被一个线程访问

2.单核（单个领导人），多线程（并行）：不同线程在访问相同的物理地址的时候，会映射到相同的缓存位置，即使发生线程切换，缓存不会失效，任何时刻只有一个线程在执行，不会出现缓存访问冲突

3.多核（多个领导人），多线程（并行）：每核至少有一个L1缓存，每个线程访问某个共享内存，多个线程在不同的核心上执行，则每个核心都会在各自cache中保留一份共享内存的缓冲，因此存在缓存不一致的情况

### 运行数据区

![1538743288228](C:\Users\17235\AppData\Roaming\Typora\typora-user-images\1538743288228.png)

程序计数器：当前线程所执行字节码的行号指示器，多线程通过轮流切换并分配处理器执行时间的方式来实现，每一个时刻，一个核心（单核，或者多核的其中一个核），只会执行一条线程指令，为了线程切换后能回到正确的执行位置，每个线程需要一个程序计数器







reference：https://www.jianshu.com/p/c15ab8664bee