---
layout: post
title: "spring学习"
description: "spring"
category: [java,spring]
tags: [spring]
---
{% include JB/setup %}

# spring学习

Aware接口

实现这些接口的bean被实例化后，可以取得一些相对的资源



## refresh方法

#### prepareBeanFactory

```
beanFactory.addBeanPostProcessor(new ApplicationContextAwareProcessor(this));
```

ApplicationContextAwareProcessor实现了BeanPostProcessor接口

在BEAN初始化之前，调用ApplicationContextAwareProcessor的postProcessBeforeInitialization，处理所有的Aware接口

```
beanFactory.ignoreDependencyInterface(EnvironmentAware.class);
```

忽略各种Aware接口的注册，因为ApplicationContextAwareProcessor把所有Aware接口都实现了



```
 // 设置几个自动装配的特殊规则     beanFactory.registerResolvableDependency(BeanFactory.class, beanFactory);     beanFactory.registerResolvableDependency(ResourceLoader.class, this);     beanFactory.registerResolvableDependency(ApplicationEventPublisher.class, this);     beanFactory.registerResolvableDependency(ApplicationContext.class, this);
```

给DefaultListableBeanFactory中resolvableDependencies赋值

```
/** Map from dependency type to corresponding autowired value */
private final Map<Class<?>, Object> resolvableDependencies = new HashMap<Class<?>, Object>(16);
```